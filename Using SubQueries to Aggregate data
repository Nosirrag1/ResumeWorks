SELECT
  Warehouse.warehouse_id,
  CONCAT (Warehouse.state, ':', Warehouse.warehouse_alias) AS Warehouse_name, 
  COUNT (Orders.order_id) AS number_of_orders, 
  (SELECT COUNT(*) FROM module5practice.warehouse_orders.orders AS Orders) AS   total_orders,
  CASE 
    WHEN COUNT(Orders.order_id)/(SELECT COUNT(*) FROM `module5practice.warehouse_orders.orders` AS Orders) <= 0.20 
    THEN 'Fulfilled 0-20% of Orders' 
    WHEN COUNT(Orders.order_id)/(SELECT COUNT(*) FROM `module5practice.warehouse_orders.orders` AS Orders) > 0.20 
    AND COUNT(ORders.order_id)/(SELECT COUNT(*)FROM `module5practice.warehouse_orders.orders`) <= 0.60 
    THEN 'Fulfilled 21-60% of Orders' 
    ELSE 'Fulfilled 21-60% of Orders'  
  END AS fullfilment_summary 
FROM module5practice.warehouse_orders.warehouse AS Warehouse
LEFT JOIN module5practice.warehouse_order.orders AS Orders
ON Orders.warehouse_id = Warehouse.warehouse_id
GROUP BY 
Warehouse.warehouse_id,
Warehouse_name
HAVING 
COUNT(Orders.order_id) > 0
